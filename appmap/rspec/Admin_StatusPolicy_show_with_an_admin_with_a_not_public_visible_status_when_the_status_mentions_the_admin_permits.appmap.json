{
  "events": [
    {
      "id": 1,
      "event": "call",
      "thread_id": 9160,
      "defined_class": "Admin::StatusPolicy",
      "method_id": "show?",
      "path": "app/policies/admin/status_policy.rb",
      "lineno": 14,
      "static": false,
      "receiver": {
        "class": "Admin::StatusPolicy",
        "object_id": 14746220,
        "value": "#<Admin::StatusPolicy:0x00007fc8e2398fc0>"
      }
    },
    {
      "id": 2,
      "event": "call",
      "thread_id": 9160,
      "defined_class": "User",
      "method_id": "role",
      "path": "app/models/user.rb",
      "lineno": 153,
      "static": false,
      "receiver": {
        "class": "User",
        "object_id": 14746160,
        "value": "#<User:0x00007fc8e21b3c00>"
      }
    },
    {
      "id": 3,
      "event": "return",
      "thread_id": 9160,
      "parent_id": 2,
      "elapsed": 0.00002865103306248784,
      "elapsed_instrumentation": 0.00010920700151473284,
      "return_value": {
        "class": "UserRole",
        "value": "#<UserRole:0x00007fc8e21b3fc0>",
        "object_id": 14746240
      }
    },
    {
      "id": 4,
      "event": "call",
      "thread_id": 9160,
      "defined_class": "UserRole",
      "method_id": "can?",
      "path": "app/models/user_role.rb",
      "lineno": 131,
      "static": false,
      "parameters": [
        {
          "name": "any_of_privileges",
          "class": "Array",
          "object_id": 14746260,
          "value": "[:manage_reports, :manage_users]",
          "kind": "rest",
          "size": 2
        }
      ],
      "receiver": {
        "class": "UserRole",
        "object_id": 14746240,
        "value": "#<UserRole:0x00007fc8e21b3fc0>"
      }
    },
    {
      "id": 5,
      "event": "call",
      "thread_id": 9160,
      "defined_class": "UserRole",
      "method_id": "computed_permissions",
      "path": "app/models/user_role.rb",
      "lineno": 139,
      "static": false,
      "receiver": {
        "class": "UserRole",
        "object_id": 14746240,
        "value": "#<UserRole:0x00007fc8e21b3fc0>"
      }
    },
    {
      "id": 6,
      "event": "call",
      "thread_id": 9160,
      "defined_class": "UserRole",
      "method_id": "everyone?",
      "path": "app/models/user_role.rb",
      "lineno": 115,
      "static": false,
      "receiver": {
        "class": "UserRole",
        "object_id": 14746240,
        "value": "#<UserRole:0x00007fc8e21b3fc0>"
      }
    },
    {
      "id": 7,
      "event": "return",
      "thread_id": 9160,
      "parent_id": 6,
      "elapsed": 0.00001140497624874115,
      "elapsed_instrumentation": 0.0000470790546387434
    },
    {
      "id": 8,
      "event": "call",
      "thread_id": 9160,
      "defined_class": "UserRole",
      "method_id": "nobody?",
      "path": "app/models/user_role.rb",
      "lineno": 119,
      "static": false,
      "receiver": {
        "class": "UserRole",
        "object_id": 14746240,
        "value": "#<UserRole:0x00007fc8e21b3fc0>"
      }
    },
    {
      "id": 9,
      "event": "return",
      "thread_id": 9160,
      "parent_id": 8,
      "elapsed": 0.0000046889763325452805,
      "elapsed_instrumentation": 0.000046968983951956034
    },
    {
      "id": 10,
      "event": "call",
      "thread_id": 9160,
      "defined_class": "UserRole",
      "method_id": "everyone",
      "path": "app/models/user_role.rb",
      "lineno": 105,
      "static": true,
      "receiver": {
        "class": "Class",
        "object_id": 62120,
        "value": "UserRole"
      }
    },
    {
      "id": 11,
      "event": "call",
      "thread_id": 9160,
      "sql_query": {
        "sql": "SELECT \"user_roles\".* FROM \"user_roles\" WHERE \"user_roles\".\"id\" = $1 LIMIT $2",
        "database_type": "postgres"
      }
    },
    {
      "id": 12,
      "event": "return",
      "thread_id": 9160,
      "parent_id": 11,
      "elapsed": 0.000451088,
      "elapsed_instrumentation": 0.00009535596473142505
    },
    {
      "id": 13,
      "event": "return",
      "thread_id": 9160,
      "parent_id": 10,
      "elapsed": 0.001504767977166921,
      "elapsed_instrumentation": 0.00012190802954137325,
      "return_value": {
        "class": "UserRole",
        "value": "#<UserRole:0x00007fc8e21ceb18>",
        "object_id": 14746280
      }
    },
    {
      "id": 14,
      "event": "return",
      "thread_id": 9160,
      "parent_id": 5,
      "elapsed": 0.0018078279681503773,
      "elapsed_instrumentation": 0.00006735604256391525,
      "return_value": {
        "class": "Integer",
        "value": "1048572",
        "object_id": 2097145
      }
    },
    {
      "id": 15,
      "event": "return",
      "thread_id": 9160,
      "parent_id": 4,
      "elapsed": 0.0018994699930772185,
      "elapsed_instrumentation": 0.00011907197767868638,
      "return_value": {
        "class": "TrueClass",
        "value": "true",
        "object_id": 20
      }
    },
    {
      "id": 16,
      "event": "call",
      "thread_id": 9160,
      "defined_class": "Status",
      "method_id": "reported?",
      "path": "app/models/status.rb",
      "lineno": 258,
      "static": false,
      "receiver": {
        "class": "Status",
        "object_id": 14746080,
        "value": "#<Status:0x00007fc8e1cf8c38>"
      }
    },
    {
      "id": 17,
      "event": "call",
      "thread_id": 9160,
      "sql_query": {
        "sql": "SELECT 1 AS one FROM \"reports\" WHERE \"reports\".\"target_account_id\" = $1 AND \"reports\".\"action_taken_at\" IS NULL AND (111361445423704049 = ANY(status_ids)) LIMIT $2",
        "database_type": "postgres"
      }
    },
    {
      "id": 18,
      "event": "return",
      "thread_id": 9160,
      "parent_id": 17,
      "elapsed": 0.000639186,
      "elapsed_instrumentation": 0.00008538697147741914
    },
    {
      "id": 19,
      "event": "return",
      "thread_id": 9160,
      "parent_id": 16,
      "elapsed": 0.0021093550021760166,
      "elapsed_instrumentation": 0.00008861400419846177
    },
    {
      "id": 20,
      "event": "call",
      "thread_id": 9160,
      "defined_class": "StatusPolicy",
      "method_id": "show?",
      "path": "app/policies/status_policy.rb",
      "lineno": 10,
      "static": false,
      "receiver": {
        "class": "StatusPolicy",
        "object_id": 14746300,
        "value": "#<StatusPolicy:0x00007fc8e23aeb90>"
      }
    },
    {
      "id": 21,
      "event": "call",
      "thread_id": 9160,
      "defined_class": "Account",
      "method_id": "suspended?",
      "path": "app/models/account.rb",
      "lineno": 237,
      "static": false,
      "receiver": {
        "class": "Account",
        "object_id": 14746100,
        "value": "#<Account:0x00007fc8e21a4750>"
      }
    },
    {
      "id": 22,
      "event": "return",
      "thread_id": 9160,
      "parent_id": 21,
      "elapsed": 0.000025032961275428534,
      "elapsed_instrumentation": 0.00006368500180542469
    },
    {
      "id": 23,
      "event": "call",
      "thread_id": 9160,
      "sql_query": {
        "sql": "SELECT 1 AS one FROM \"mentions\" WHERE \"mentions\".\"status_id\" = $1 AND \"mentions\".\"account_id\" = $2 LIMIT $3",
        "database_type": "postgres"
      }
    },
    {
      "id": 24,
      "event": "return",
      "thread_id": 9160,
      "parent_id": 23,
      "elapsed": 0.000656936,
      "elapsed_instrumentation": 0.00008581700967624784
    },
    {
      "id": 25,
      "event": "return",
      "thread_id": 9160,
      "parent_id": 20,
      "elapsed": 0.0019744960009120405,
      "elapsed_instrumentation": 0.0001303579774685204,
      "return_value": {
        "class": "TrueClass",
        "value": "true",
        "object_id": 20
      }
    },
    {
      "id": 26,
      "event": "return",
      "thread_id": 9160,
      "parent_id": 1,
      "elapsed": 0.006614947982598096,
      "elapsed_instrumentation": 0.0002857850049622357,
      "return_value": {
        "class": "TrueClass",
        "value": "true",
        "object_id": 20
      }
    }
  ],
  "version": "1.12.0",
  "metadata": {
    "app": "mastodon",
    "language": {
      "name": "ruby",
      "engine": "ruby",
      "version": "3.2.2"
    },
    "client": {
      "name": "appmap",
      "url": "https://github.com/applandinc/appmap-ruby",
      "version": "0.102.1"
    },
    "frameworks": [
      {
        "name": "rails",
        "version": "7.1.1"
      },
      {
        "name": "rspec",
        "version": "3.12.2"
      }
    ],
    "git": {
      "repository": "https://github.com/sgrigson/mastodon.git",
      "branch": "appmap-config",
      "commit": "2c1ae2317e8741caf25b51e9b3b2c15776c54ae3",
      "git_last_annotated_tag": "0.1.2-14608-g2c1ae2317e8741caf25b51e9b3b2c15776c54ae3",
      "git_last_tag": "v4.2.0",
      "git_commits_since_last_annotated_tag": 0,
      "git_commits_since_last_tag": 0
    },
    "name": "Admin::StatusPolicy show? with an admin with a not public visible status when the status mentions the admin permits",
    "source_location": "spec/policies/admin/status_policy_spec.rb",
    "recorder": {
      "name": "rspec",
      "type": "tests"
    },
    "test_status": "succeeded"
  },
  "classMap": [
    {
      "name": "app",
      "type": "package",
      "children": [
        {
          "name": "policies",
          "type": "package",
          "children": [
            {
              "name": "admin",
              "type": "package",
              "children": [
                {
                  "name": "Admin",
                  "type": "class",
                  "children": [
                    {
                      "name": "StatusPolicy",
                      "type": "class",
                      "children": [
                        {
                          "name": "show?",
                          "type": "function",
                          "static": false,
                          "location": "app/policies/admin/status_policy.rb:14"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "StatusPolicy",
              "type": "class",
              "children": [
                {
                  "name": "show?",
                  "type": "function",
                  "static": false,
                  "location": "app/policies/status_policy.rb:10"
                }
              ]
            }
          ]
        },
        {
          "name": "models",
          "type": "package",
          "children": [
            {
              "name": "User",
              "type": "class",
              "children": [
                {
                  "name": "role",
                  "type": "function",
                  "static": false,
                  "location": "app/models/user.rb:153"
                }
              ]
            },
            {
              "name": "UserRole",
              "type": "class",
              "children": [
                {
                  "name": "can?",
                  "type": "function",
                  "static": false,
                  "location": "app/models/user_role.rb:131"
                },
                {
                  "name": "computed_permissions",
                  "type": "function",
                  "static": false,
                  "location": "app/models/user_role.rb:139"
                },
                {
                  "name": "everyone?",
                  "type": "function",
                  "static": false,
                  "location": "app/models/user_role.rb:115"
                },
                {
                  "name": "nobody?",
                  "type": "function",
                  "static": false,
                  "location": "app/models/user_role.rb:119"
                },
                {
                  "name": "everyone",
                  "type": "function",
                  "static": true,
                  "location": "app/models/user_role.rb:105"
                }
              ]
            },
            {
              "name": "Status",
              "type": "class",
              "children": [
                {
                  "name": "reported?",
                  "type": "function",
                  "static": false,
                  "location": "app/models/status.rb:258"
                }
              ]
            },
            {
              "name": "Account",
              "type": "class",
              "children": [
                {
                  "name": "suspended?",
                  "type": "function",
                  "static": false,
                  "location": "app/models/account.rb:237"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "database",
      "name": "Database",
      "children": [
        {
          "type": "query",
          "name": "SELECT \"user_roles\".* FROM \"user_roles\" WHERE \"user_roles\".\"id\" = $1 LIMIT $2"
        },
        {
          "type": "query",
          "name": "SELECT 1 AS one FROM \"reports\" WHERE \"reports\".\"target_account_id\" = $1 AND \"reports\".\"action_taken_at\" IS NULL AND (111361445423704049 = ANY(status_ids)) LIMIT $2"
        },
        {
          "type": "query",
          "name": "SELECT 1 AS one FROM \"mentions\" WHERE \"mentions\".\"status_id\" = $1 AND \"mentions\".\"account_id\" = $2 LIMIT $3"
        }
      ]
    }
  ]
}